#!/bin/bash
#
# Settings Manager for YouTube Downloader
#

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SETTINGS_FILE="$SCRIPT_DIR/settings.json"

# Colors
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m'

case "$1" in
    "edit"|"open")
        echo -e "${YELLOW}üìù Opening settings in Cursor...${NC}"
        if command -v cursor &> /dev/null; then
            cursor "$SETTINGS_FILE"
        else
            open "$SETTINGS_FILE"
        fi
        ;;
    "show"|"view")
        echo -e "${CYAN}‚öôÔ∏è  Current Settings:${NC}"
        echo -e "${BLUE}===================${NC}"
        cat "$SETTINGS_FILE" | python3 -m json.tool
        ;;
    "mp3")
        echo -e "${GREEN}üéµ Setting format to MP3...${NC}"
        python3 -c "
import json
with open('$SETTINGS_FILE', 'r') as f: settings = json.load(f)
settings['output_format'] = 'mp3'
with open('$SETTINGS_FILE', 'w') as f: json.dump(settings, f, indent=2)
print('‚úÖ Format set to MP3')
"
        ;;
    "mp4")
        echo -e "${GREEN}üé¨ Setting format to MP4...${NC}"
        python3 -c "
import json
with open('$SETTINGS_FILE', 'r') as f: settings = json.load(f)
settings['output_format'] = 'mp4'
with open('$SETTINGS_FILE', 'w') as f: json.dump(settings, f, indent=2)
print('‚úÖ Format set to MP4')
"
        ;;
    "wav")
        echo -e "${GREEN}üé∂ Setting format to WAV...${NC}"
        python3 -c "
import json
with open('$SETTINGS_FILE', 'r') as f: settings = json.load(f)
settings['output_format'] = 'wav'
with open('$SETTINGS_FILE', 'w') as f: json.dump(settings, f, indent=2)
print('‚úÖ Format set to WAV')
"
        ;;
    "dir"|"directory")
        if [ -z "$2" ]; then
            echo -e "${YELLOW}Usage: $0 directory <path>${NC}"
            echo -e "${BLUE}Example: $0 directory ~/Desktop/YouTube${NC}"
            exit 1
        fi
        echo -e "${GREEN}üìÅ Setting output directory to: $2${NC}"
        python3 -c "
import json
with open('$SETTINGS_FILE', 'r') as f: settings = json.load(f)
settings['output_directory'] = '$2'
with open('$SETTINGS_FILE', 'w') as f: json.dump(settings, f, indent=2)
print('‚úÖ Output directory updated')
"
        ;;
    "reset")
        echo -e "${YELLOW}üîÑ Resetting to default settings...${NC}"
        rm -f "$SETTINGS_FILE"
        python3 -c "from config import load_settings; load_settings()"
        echo -e "${GREEN}‚úÖ Settings reset to defaults${NC}"
        ;;
    *)
        echo -e "${CYAN}‚öôÔ∏è  Settings Manager${NC}"
        echo -e "${BLUE}=================${NC}"
        echo ""
        echo "Usage:"
        echo "  $0 edit              - Open settings in Cursor"
        echo "  $0 show              - Display current settings"
        echo "  $0 mp3               - Set format to MP3"
        echo "  $0 mp4               - Set format to MP4"
        echo "  $0 wav               - Set format to WAV"
        echo "  $0 directory <path>  - Set output directory"
        echo "  $0 reset             - Reset to defaults"
        echo ""
        echo "Examples:"
        echo "  $0 edit"
        echo "  $0 mp4"
        echo "  $0 directory ~/Desktop/YouTube"
        ;;
esac 